function menu(t,e,{elements:s,classList:i}){t.onclick=()=>{if(t.classList.contains(e))t.style.top=t.style.left="";else{let e=t.getBoundingClientRect();t.style.left=e.left+"px",t.style.top=e.top+"px"}t.classList.toggle(e),s.forEach((t,e)=>{i[e]&&t.classList.toggle(i[e])})}}class Slider{constructor(t,{pointClassName:e,pointsElem:s,time:i,arrowLeft:n,arrowRight:r}){this.sliderLine=t.querySelector("[data-slider-line]"),this.sliderLine&&(this.sliderLine.style.cssText="transform: translateX(0px);",this.pointsElem=s,this.pointClassName=e||"pointClassName",this.pointNumber=0,this.interval,this.time=i,this.isPressed=!1,this.moveWithPressedMouse=this.moveWithPressedMouse.bind(this),parseInt(i)&&(this.startTimer(),this.sliderLine.addEventListener("mouseenter",this.stopTimer.bind(this)),this.sliderLine.addEventListener("mouseleave",this.startTimer.bind(this))),t.addEventListener("click",this.handleEvent.bind(this)),t.addEventListener("mousedown",this.handleEvent.bind(this)),t.addEventListener("mouseup",this.handleEvent.bind(this)),window.addEventListener("resize",this.reset.bind(this)))}handleEvent(t){let e=t.target.closest("[data-slider-point]");if(e&&"click"==t.type){if(e.classList.contains(this.pointClassName)||t.preventDefault(),e.dataset.sliderPoint-1==this.pointNumber)return;return this.time&&(this.stopTimer(),this.startTimer()),void this.changePoints(e.dataset.sliderPoint-1)}if(t.target.closest("[data-slider-line]"))switch(t.type){case"mousedown":this.startWithPressedMouse(t);break;case"dbclick":case"mouseup":this.endWithPressedMouse(t.clientX)}}moveSlider(t){let e=this.sliderLine.scrollWidth/this.sliderLine.children.length*t;this.sliderLine.style.transform=`translateX(-${e}px)`}changePoints(t){t=t<0?this.sliderLine.children.length-1:t>this.sliderLine.children.length-1?0:t,this.pointsElem.children[this.pointNumber].classList.remove(this.pointClassName),this.pointsElem.children[t].classList.add(this.pointClassName),this.pointNumber=t,this.moveSlider(t)}startWithPressedMouse(t){this.isPressed=!0,this.startDistance=t.clientX,this.initialSlide=t.target.closest("[data-slider-item]"),this.initialTransform=+getComputedStyle(this.sliderLine).transform.split(",")[4],this.sliderLine.style.transition="initial",window.addEventListener("mousemove",this.moveWithPressedMouse)}endWithPressedMouse(t){if(!this.isPressed)return;this.isPressed=!1,this.sliderLine.style.transition="";let e=t-this.startDistance;Math.abs(e)<.3*this.sliderLine.offsetWidth?this.sliderLine.style.transform=`translateX(${this.initialTransform}px)`:this.changePoints(e<0?this.pointNumber+1:this.pointNumber-1),window.removeEventListener("mousemove",this.moveWithPressedMouse)}moveWithPressedMouse(t){let e=t.clientX-this.startDistance,s=this.initialTransform+e,i=-(this.sliderLine.scrollWidth-this.sliderLine.clientWidth);s=s>=0?0:s<=i?i:s,this.sliderLine.style.transform=`translateX(${s}px)`;let n=document.elementFromPoint(t.clientX,t.clientY);this.sliderLine.contains(n)||this.endWithPressedMouse(this.prevClientX),this.prevClientX=t.clientX,t.preventDefault()}startTimer(){this.interval=setInterval(()=>{console.log(`setTimeout: ${this.timeout}`);let t=this.pointNumber+1;this.changePoints(t)},1e3*this.time)}stopTimer(){clearInterval(this.interval)}reset(){this.sliderLine.style.transform="translateX(0px)",this.changePoints(0)}}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lbnUuanMiLCJzbGlkZXIuanMiXSwibmFtZXMiOlsibWVudSIsImJ0biIsImJ0bkNsYXNzIiwiZWxlbWVudHMiLCJjbGFzc0xpc3QiLCJvbmNsaWNrIiwiY29udGFpbnMiLCJzdHlsZSIsInRvcCIsImxlZnQiLCJjb29yZHMiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b2dnbGUiLCJmb3JFYWNoIiwiaXRlbSIsImkiLCJTbGlkZXIiLCJbb2JqZWN0IE9iamVjdF0iLCJzbGlkZXIiLCJwb2ludENsYXNzTmFtZSIsInBvaW50c0VsZW0iLCJ0aW1lIiwiYXJyb3dMZWZ0IiwiYXJyb3dSaWdodCIsInRoaXMiLCJzbGlkZXJMaW5lIiwicXVlcnlTZWxlY3RvciIsImNzc1RleHQiLCJwb2ludE51bWJlciIsImludGVydmFsIiwiaXNQcmVzc2VkIiwibW92ZVdpdGhQcmVzc2VkTW91c2UiLCJiaW5kIiwicGFyc2VJbnQiLCJzdGFydFRpbWVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN0b3BUaW1lciIsImhhbmRsZUV2ZW50Iiwid2luZG93IiwicmVzZXQiLCJldmVudCIsInBvaW50IiwidGFyZ2V0IiwiY2xvc2VzdCIsInR5cGUiLCJwcmV2ZW50RGVmYXVsdCIsImRhdGFzZXQiLCJzbGlkZXJQb2ludCIsImNoYW5nZVBvaW50cyIsInN0YXJ0V2l0aFByZXNzZWRNb3VzZSIsImVuZFdpdGhQcmVzc2VkTW91c2UiLCJjbGllbnRYIiwiaW5kZXgiLCJzY3JvbGxXaWR0aCIsImNoaWxkcmVuIiwibGVuZ3RoIiwidHJhbnNmb3JtIiwicmVtb3ZlIiwiYWRkIiwibW92ZVNsaWRlciIsInN0YXJ0RGlzdGFuY2UiLCJpbml0aWFsU2xpZGUiLCJpbml0aWFsVHJhbnNmb3JtIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsInNwbGl0IiwidHJhbnNpdGlvbiIsImRpZmZPZkRpc3RhbmNlIiwiTWF0aCIsImFicyIsIm9mZnNldFdpZHRoIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNoaWZ0IiwibWF4U2hpZnQiLCJjbGllbnRXaWR0aCIsImN1cnJlbnRFbGVtIiwiZG9jdW1lbnQiLCJlbGVtZW50RnJvbVBvaW50IiwiY2xpZW50WSIsInByZXZDbGllbnRYIiwic2V0SW50ZXJ2YWwiLCJjb25zb2xlIiwibG9nIiwidGltZW91dCIsImNsZWFySW50ZXJ2YWwiXSwibWFwcGluZ3MiOiJBQUFBLFNBQUFBLEtBQUFDLEVBQUFDLEdBQUFDLFNBQ0FBLEVBQUFDLFVBQ0FBLElBRUFILEVBQUFJLFFBQUEsS0FDQSxHQUFBSixFQUFBRyxVQUFBRSxTQUFBSixHQUtBRCxFQUFBTSxNQUFBQyxJQUFBUCxFQUFBTSxNQUFBRSxLQUFBLE9BTEEsQ0FDQSxJQUFBQyxFQUFBVCxFQUFBVSx3QkFDQVYsRUFBQU0sTUFBQUUsS0FBQUMsRUFBQUQsS0FBQSxLQUNBUixFQUFBTSxNQUFBQyxJQUFBRSxFQUFBRixJQUFBLEtBSUFQLEVBQUFHLFVBQUFRLE9BQUFWLEdBQ0FDLEVBQUFVLFFBQUEsQ0FBQUMsRUFBQUMsS0FDQVgsRUFBQVcsSUFBQUQsRUFBQVYsVUFBQVEsT0FBQVIsRUFBQVcsT0NiQSxNQUFBQyxPQUNBQyxZQUFBQyxHQUFBQyxlQUFBQSxFQUFBQyxXQUFBQSxFQUFBQyxLQUFBQSxFQUFBQyxVQUFBQSxFQUFBQyxXQUFBQSxJQUNBQyxLQUFBQyxXQUFBUCxFQUFBUSxjQUFBLHNCQUNBRixLQUFBQyxhQUVBRCxLQUFBQyxXQUFBbEIsTUFBQW9CLFFBQUEsOEJBRUFILEtBQUFKLFdBQUFBLEVBQ0FJLEtBQUFMLGVBQUFBLEdBQUEsaUJBQ0FLLEtBQUFJLFlBQUEsRUFFQUosS0FBQUssU0FDQUwsS0FBQUgsS0FBQUEsRUFFQUcsS0FBQU0sV0FBQSxFQUNBTixLQUFBTyxxQkFBQVAsS0FBQU8scUJBQUFDLEtBQUFSLE1BRUFTLFNBQUFaLEtBQ0FHLEtBQUFVLGFBQ0FWLEtBQUFDLFdBQUFVLGlCQUFBLGFBQUFYLEtBQUFZLFVBQUFKLEtBQUFSLE9BQ0FBLEtBQUFDLFdBQUFVLGlCQUFBLGFBQUFYLEtB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QXRDLEVBQUFXLFFBRUFYLEVBQUFLLGlCQUlBNUIsYUFDQU8sS0FBQUssU0FBQWtELFlBQUEsS0FDQUMsUUFBQUMsSUFBQSxlQUFBekQsS0FBQTBELFdBQ0EsSUFBQTlCLEVBQUE1QixLQUFBSSxZQUFBLEVBQ0FKLEtBQUF3QixhQUFBSSxJQUNBLElBQUE1QixLQUFBSCxNQUdBSixZQUNBa0UsY0FBQTNELEtBQUFLLFVBR0FaLFFBQ0FPLEtBQUFDLFdBQUFsQixNQUFBaUQsVUFBQSxrQkFDQWhDLEtBQUF3QixhQUFBIiwiZmlsZSI6ImxpYnMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gbWVudShidG4sIGJ0bkNsYXNzLCB7XHJcbiAgICBlbGVtZW50cyxcclxuICAgIGNsYXNzTGlzdCxcclxufSkge1xyXG4gICAgYnRuLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYoIWJ0bi5jbGFzc0xpc3QuY29udGFpbnMoYnRuQ2xhc3MpKSB7XHJcbiAgICAgICAgICAgIGxldCBjb29yZHMgPSBidG4uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgIGJ0bi5zdHlsZS5sZWZ0ID0gY29vcmRzLmxlZnQgKyAncHgnO1xyXG4gICAgICAgICAgICBidG4uc3R5bGUudG9wID0gY29vcmRzLnRvcCArICdweCc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYnRuLnN0eWxlLnRvcCA9IGJ0bi5zdHlsZS5sZWZ0ID0gXCJcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgYnRuLmNsYXNzTGlzdC50b2dnbGUoYnRuQ2xhc3MpO1xyXG4gICAgICAgIGVsZW1lbnRzLmZvckVhY2goKGl0ZW0sIGkpID0+IHtcclxuICAgICAgICAgICAgaWYoY2xhc3NMaXN0W2ldKWl0ZW0uY2xhc3NMaXN0LnRvZ2dsZShjbGFzc0xpc3RbaV0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59OyIsIlxyXG5jbGFzcyBTbGlkZXIge1xyXG4gICAgY29uc3RydWN0b3Ioc2xpZGVyLCB7cG9pbnRDbGFzc05hbWUsIHBvaW50c0VsZW0sIHRpbWUsIGFycm93TGVmdCwgYXJyb3dSaWdodH0pIHsgLy90aGUgdGltZSBhcmd1bWVudCB0YWtlcyBhIG51bWJlciB2YWx1ZSBhcyBzZWNvbmRzXHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lID0gc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXNsaWRlci1saW5lXScpO1xyXG4gICAgICAgIGlmKCF0aGlzLnNsaWRlckxpbmUpIHJldHVybjtcclxuXHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLmNzc1RleHQgPSBcInRyYW5zZm9ybTogdHJhbnNsYXRlWCgwcHgpO1wiXHJcblxyXG4gICAgICAgIHRoaXMucG9pbnRzRWxlbSA9IHBvaW50c0VsZW07XHJcbiAgICAgICAgdGhpcy5wb2ludENsYXNzTmFtZSA9IHBvaW50Q2xhc3NOYW1lIHx8ICdwb2ludENsYXNzTmFtZSc7XHJcbiAgICAgICAgdGhpcy5wb2ludE51bWJlciA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuaW50ZXJ2YWw7XHJcbiAgICAgICAgdGhpcy50aW1lID0gdGltZTtcclxuXHJcbiAgICAgICAgdGhpcy5pc1ByZXNzZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm1vdmVXaXRoUHJlc3NlZE1vdXNlID0gdGhpcy5tb3ZlV2l0aFByZXNzZWRNb3VzZS5iaW5kKHRoaXMpO1xyXG5cclxuICAgICAgICBpZihwYXJzZUludCh0aW1lKSkge1xyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0VGltZXIoKTsgIFxyXG4gICAgICAgICAgICB0aGlzLnNsaWRlckxpbmUuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIHRoaXMuc3RvcFRpbWVyLmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICB0aGlzLnNsaWRlckxpbmUuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIHRoaXMuc3RhcnRUaW1lci5iaW5kKHRoaXMpKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBzbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZUV2ZW50LmJpbmQodGhpcykpO1xyXG4gICAgICAgIHNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLmhhbmRsZUV2ZW50LmJpbmQodGhpcykpO1xyXG4gICAgICAgIHNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5oYW5kbGVFdmVudC5iaW5kKHRoaXMpKTtcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5yZXNldC5iaW5kKHRoaXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVFdmVudChldmVudCkge1xyXG5cclxuICAgICAgICBsZXQgcG9pbnQgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnW2RhdGEtc2xpZGVyLXBvaW50XScpO1xyXG4gICAgICAgIGlmKHBvaW50ICYmIGV2ZW50LnR5cGUgPT0gXCJjbGlja1wiKSB7XHJcbiAgICAgICAgICAgIGlmKCFwb2ludC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5wb2ludENsYXNzTmFtZSkpIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IC8vcHJldmVudCB0aGUgcHJlc3NlZCBsaW5rIGdvaW5nIGlmIGl0IGlzIHRoZSBmaXJzdCB0aW1lXHJcbiAgICAgICAgICAgIGlmKHBvaW50LmRhdGFzZXQuc2xpZGVyUG9pbnQgLSAxID09IHRoaXMucG9pbnROdW1iZXIpIHJldHVybjsgLy9pZiB0aGUgcHJlc3NlZCBidXR0b24gaXMgdGhlIHNhbWUgb25lIGxpa2UgaW4gdGhlIHByZXZpb3VzIHRpbWUgdGhlbiB0byByZXR1cm5cclxuICAgICAgICAgICAgaWYodGhpcy50aW1lKSB7IC8vIGlmIHRoZSBwb2ludCBoYXZlIHByZXNzZWQgdGhlbiB0byBjYW5jZWwgdGhlIGN1cnJlbnQgdGltZXIgYW5kIHN0YXJ0IGl0IHVudGlsbCB0aGUgdHJhbnNpdGlvbiBlbmQgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BUaW1lcigpOyAvLyBzdG9wIHRoZSB0aW1lciBhbnl3YXlcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRUaW1lcigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlUG9pbnRzKHBvaW50LmRhdGFzZXQuc2xpZGVyUG9pbnQgLSAxKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ1tkYXRhLXNsaWRlci1saW5lXScpKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaChldmVudC50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdtb3VzZWRvd24nOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRXaXRoUHJlc3NlZE1vdXNlKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhazsgIFxyXG4gICAgICAgICAgICAgICAgY2FzZSAnZGJjbGljayc6ICAgIFxyXG4gICAgICAgICAgICAgICAgY2FzZSAnbW91c2V1cCc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRXaXRoUHJlc3NlZE1vdXNlKGV2ZW50LmNsaWVudFgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBcclxuICAgICAgICAvL2lmKGV2ZW50LnRhcmdldC5jbG9zZXN0KCdbZGF0YS1zbGlkZXItYXJyb3ddJykpIHRoaXMuYXJyb3dzKGV2ZW50LnRhcmdldCk7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgLyogYXJyb3dzKGVsZW0pIHtcclxuICAgICAgICBsZXQgb2Zmc2V0V2lkdGggPSB0aGlzLnNsaWRlckxpbmUub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgbGV0IGxlZnQgPSBwYXJzZUludCh0aGlzLnNsaWRlckxpbmUuc3R5bGUubGVmdCk7XHJcbiAgICAgICAgbGV0IGFtb3VudCA9IChlbGVtLmRhdGFzZXQuc2xpZGVyQXJyb3cgPT0gJ2xlZnQnKSA/IGxlZnQgKyBvZmZzZXRXaWR0aCA6IGxlZnQgLSBvZmZzZXRXaWR0aDtcclxuICAgICAgICBhbW91bnQgPSAoYW1vdW50ID4gMCkgPyAwIDpcclxuICAgICAgICAvLyBpZiB0aGUgcmVzdCBwYXJ0IG9mIHNsaWRlciBsaW5lIHNtYWxsZXIgdGhhbiAxMHB4IHRoZW4gbm8gY2hhbmdlc1xyXG4gICAgICAgICh0aGlzLnNsaWRlckxpbmUuc2Nyb2xsV2lkdGggKyBhbW91bnQgPCAxMCkgPyBhbW91bnQgKyBvZmZzZXRXaWR0aCA6IGFtb3VudDtcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUubGVmdCA9IGFtb3VudCArIFwicHhcIjtcclxuICAgIH0gKi9cclxuXHJcbiAgICBtb3ZlU2xpZGVyKGluZGV4KSB7IC8vIGNoYW5nZXMgKG1vdmVzKSB0aGUgc2xpZGVyIHRhcGUgKHNsaWRlciBsaW5lKSBwb3NpdGlvblxyXG4gICAgICAgIGxldCBsZWZ0ID0gdGhpcy5zbGlkZXJMaW5lLnNjcm9sbFdpZHRoIC8gdGhpcy5zbGlkZXJMaW5lLmNoaWxkcmVuLmxlbmd0aCAqIGluZGV4O1xyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgtJHtsZWZ0fXB4KWA7XHJcbiAgICB9XHJcblxyXG4gICAgY2hhbmdlUG9pbnRzKGluZGV4KSB7IC8vIGNoYW5nZXMgYSBjbGFzcyBvZiB0aGUgcHJlc3NlZCBidXR0b24gKHNsaWRlciBwb2ludCkgYW5kIG1vdmVzIHRoZSBzbGlkZXIgdGFwZSAoc2xpZGVyIGxpbmUpICBcclxuICAgICAgICBpbmRleCA9IChpbmRleCA8IDApID8gdGhpcy5zbGlkZXJMaW5lLmNoaWxkcmVuLmxlbmd0aCAtIDEgOiBcclxuICAgICAgICAgICAgICAgIChpbmRleCA+IHRoaXMuc2xpZGVyTGluZS5jaGlsZHJlbi5sZW5ndGggLSAxKSA/IDAgOiBpbmRleDtcclxuXHJcbiAgICAgICAgdGhpcy5wb2ludHNFbGVtLmNoaWxkcmVuW3RoaXMucG9pbnROdW1iZXJdLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5wb2ludENsYXNzTmFtZSk7XHJcbiAgICAgICAgdGhpcy5wb2ludHNFbGVtLmNoaWxkcmVuW2luZGV4XS5jbGFzc0xpc3QuYWRkKHRoaXMucG9pbnRDbGFzc05hbWUpO1xyXG4gICAgICAgIHRoaXMucG9pbnROdW1iZXIgPSBpbmRleDtcclxuICAgICAgICB0aGlzLm1vdmVTbGlkZXIoaW5kZXgpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBzdGFydFdpdGhQcmVzc2VkTW91c2UoZXZlbnQpIHtcclxuICAgICAgICB0aGlzLmlzUHJlc3NlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zdGFydERpc3RhbmNlID0gZXZlbnQuY2xpZW50WDtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0aWFsU2xpZGUgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnW2RhdGEtc2xpZGVyLWl0ZW1dJyk7IC8vZGVjaXNpb24gb2YgY3VycmVudGx5IGZvciBhIHNpbmdsZSB2aXNpYmxlIHNsaWRlIG9mIHRoZSBzbGlkZXJcclxuXHJcbiAgICAgICAgdGhpcy5pbml0aWFsVHJhbnNmb3JtID0gK2dldENvbXB1dGVkU3R5bGUodGhpcy5zbGlkZXJMaW5lKS50cmFuc2Zvcm0uc3BsaXQoJywnKVs0XTtcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUudHJhbnNpdGlvbiA9ICdpbml0aWFsJztcclxuXHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMubW92ZVdpdGhQcmVzc2VkTW91c2UpO1xyXG4gICAgfVxyXG4gICAgZW5kV2l0aFByZXNzZWRNb3VzZShjbGllbnRYKSB7XHJcbiAgICAgICAgaWYoIXRoaXMuaXNQcmVzc2VkKSByZXR1cm47XHJcblxyXG4gICAgICAgIHRoaXMuaXNQcmVzc2VkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLnRyYW5zaXRpb24gPSAnJztcclxuXHJcbiAgICAgICAgbGV0IGRpZmZPZkRpc3RhbmNlID0gY2xpZW50WCAtIHRoaXMuc3RhcnREaXN0YW5jZTtcclxuICAgICAgICBpZihNYXRoLmFicyhkaWZmT2ZEaXN0YW5jZSkgIDwgdGhpcy5zbGlkZXJMaW5lLm9mZnNldFdpZHRoICogLjMpIHtcclxuICAgICAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKCR7dGhpcy5pbml0aWFsVHJhbnNmb3JtfXB4KWA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VQb2ludHMoKGRpZmZPZkRpc3RhbmNlIDwgMCkgPyB0aGlzLnBvaW50TnVtYmVyICsgMSA6IHRoaXMucG9pbnROdW1iZXIgLSAxKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm1vdmVXaXRoUHJlc3NlZE1vdXNlKTtcclxuICAgIH1cclxuICAgIG1vdmVXaXRoUHJlc3NlZE1vdXNlKGV2ZW50KSB7XHJcbiAgICAgICAgbGV0IGRpZmZPZkRpc3RhbmNlID0gIGV2ZW50LmNsaWVudFggLSB0aGlzLnN0YXJ0RGlzdGFuY2U7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IHNoaWZ0ID0gdGhpcy5pbml0aWFsVHJhbnNmb3JtICsgZGlmZk9mRGlzdGFuY2U7XHJcbiAgICAgICAgbGV0IG1heFNoaWZ0ID0gLSh0aGlzLnNsaWRlckxpbmUuc2Nyb2xsV2lkdGggLSB0aGlzLnNsaWRlckxpbmUuY2xpZW50V2lkdGgpO1xyXG4gICAgICAgIHNoaWZ0ID0gKHNoaWZ0ID49IDApID8gMCA6XHJcbiAgICAgICAgICAgICAgICAoc2hpZnQgPD0gbWF4U2hpZnQpID8gbWF4U2hpZnQgOiBzaGlmdDsgICAgICAgXHJcblxyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgke3NoaWZ0fXB4KWA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGN1cnJlbnRFbGVtID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZKTtcclxuICAgICAgICBpZighdGhpcy5zbGlkZXJMaW5lLmNvbnRhaW5zKGN1cnJlbnRFbGVtKSkgdGhpcy5lbmRXaXRoUHJlc3NlZE1vdXNlKHRoaXMucHJldkNsaWVudFgpO1xyXG5cclxuICAgICAgICB0aGlzLnByZXZDbGllbnRYID0gZXZlbnQuY2xpZW50WDsgXHJcblxyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHN0YXJ0VGltZXIoKSB7XHJcbiAgICAgICAgdGhpcy5pbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYHNldFRpbWVvdXQ6ICR7dGhpcy50aW1lb3V0fWApO1xyXG4gICAgICAgICAgICBsZXQgaW5kZXggPSB0aGlzLnBvaW50TnVtYmVyICsgMTtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VQb2ludHMoaW5kZXgpO1xyXG4gICAgICAgIH0sIHRoaXMudGltZSAqIDEwMDApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBzdG9wVGltZXIoKSB7XHJcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKTtcclxuICAgIH1cclxuXHJcbiAgICByZXNldCgpIHtcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoMHB4KWA7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VQb2ludHMoMCk7XHJcbiAgICB9XHJcbn07XHJcblxyXG4vLyBQYXR0ZXJuIG9mIHRoZSBIVE1MIHNsaWRlcjpcclxuLy8gYmxvY2sgc2xpZGVyICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBkZWZpbmVzIHRoZSB0b3RhbCB3aWR0aCBvZiB0aGUgc2xpZGVyJ3MgcGFnZSAoY29udGFpbmVyKVxyXG4vLyAgICAgYmxvY2sgc2xpZGVyLWNvbnRhaW5lciAgICAgICAgICAgIC8vIGRlZmluZXMgYSB3aWR0aCBvZiB0aGUgc2xpZGVyIFxyXG4vLyAgICAgICAgIGJsb2NrIFtkYXRhLXNsaWRlci1saW5lXSAgICAgICAgICAgICAvLyBkZWZpbmVzIHRoZSB0YXBlIG9mIHRoZSBzbGlkZXIsIHRoYXQgbW92ZXMgdGhyb3VnaFxyXG4vLyAgICAgICAgICAgICBibG9ja3MgW2RhdGEtc2xpZGVyLWl0ZW09J251bWJlciddICogblxyXG4vLyAgICAgICAgIGJsb2NrIHNsaWRlci1hcnJvd3MgICBcclxuLy8gICAgICAgICBibG9jayBzbGlkZXItcG9pbnRzXHJcbi8vICAgICAgICAgICAgIGJsb2NrcyBbZGF0YS1zbGlkZXItcG9pbnQ9J251bWJlciddICogblxyXG5cclxuXHJcblxyXG5cclxuLy90aGlzLnRyYW5zaXRpb25TdGFydFRpbWVyKCk7IC8vIHVzZSB0cmFuc2l0aW9uU3RhcnRUaW1lciBpbnN0ZWFkIHVzdWFsbCBzdGFydFRpbWVyIHRvIGNvbnNpZGVyIHRyYW5zaXRpb24gdGltZVxyXG5cclxuLy90aGlzLnNsaWRlckxpbmUub250cmFuc2l0aW9uZW5kID0gZmFsc2U7XHJcblxyXG4vLyB0cmFuc2l0aW9uU3RhcnRUaW1lcigpIHsgLy8gc3RhcnRzIHRoZSBuZXh0IHRpbWUgaW50ZXJ2YWwgYWZ0ZXIgdGhlIGN1cnJlbnQgdHJhbnNpdGlvbiBvbmx5XHJcbi8vICAgICBpZihwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGUodGhpcy5zbGlkZXJMaW5lKS50cmFuc2l0aW9uRHVyYXRpb24pKSB7IC8vIGlmIHRoZXJlJ3Mgc29tZSBhbmltYXRpb25cclxuLy8gICAgICAgICB0aGlzLnNsaWRlckxpbmUub250cmFuc2l0aW9uZW5kID0gKCkgPT4ge1xyXG4vLyAgICAgICAgICAgICB0aGlzLnN0YXJ0VGltZXIoKTtcclxuLy8gICAgICAgICAgICAgdGhpcy5zbGlkZXJMaW5lLm9udHJhbnNpdGlvbmVuZCA9IGZhbHNlO1xyXG4vLyAgICAgICAgIH1cclxuLy8gICAgIH0gZWxzZSB7XHJcbi8vICAgICAgICAgdGhpcy5zdGFydFRpbWVyKCk7XHJcbi8vICAgICB9XHJcbi8vIH1cclxuXHJcbiJdfQ==
