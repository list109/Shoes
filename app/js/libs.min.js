function menu(t,e,{elements:s,classList:i}){t.onclick=()=>{if(t.classList.contains(e))t.style.top=t.style.left="";else{let e=t.getBoundingClientRect();t.style.left=e.left+"px",t.style.top=e.top+"px"}t.classList.toggle(e),s.forEach((t,e)=>{i[e]&&t.classList.toggle(i[e])})}}class Slider{constructor(t,{pointClassName:e,pointsElem:s,time:i,arrowLeft:n,arrowRight:r}){this.sliderLine=t.querySelector("[data-slider-line]"),this.sliderLine&&(this.sliderLine.style.cssText="transform: translateX(0px);",this.pointsElem=s,this.pointClassName=e||"pointClassName",this.pointNumber=0,this.interval,this.time=i,this.isPressed=!1,this.moveWithPressedMouse=this.moveWithPressedMouse.bind(this),parseInt(i)&&(this.startTimer(),this.sliderLine.addEventListener("mouseenter",this.stopTimer.bind(this)),this.sliderLine.addEventListener("mouseleave",this.startTimer.bind(this))),t.addEventListener("click",this.handleEvent.bind(this)),t.addEventListener("mousedown",this.handleEvent.bind(this)),t.addEventListener("mouseup",this.handleEvent.bind(this)),window.addEventListener("resize",this.reset.bind(this)))}handleEvent(t){let e=t.target.closest("[data-slider-point]");if(e&&"click"==t.type){if(e.classList.contains(this.pointClassName)||t.preventDefault(),e.dataset.sliderPoint-1==this.pointNumber)return;return this.time&&(this.stopTimer(),this.startTimer()),void this.changePoints(e.dataset.sliderPoint-1)}if(t.target.closest("[data-slider-line]"))switch(t.type){case"mousedown":this.startWithPressedMouse(t);break;case"dbclick":case"mouseup":this.endWithPressedMouse(t.clientX)}}moveSlider(t){let e=this.sliderLine.scrollWidth/this.sliderLine.children.length*t;this.sliderLine.style.transform=`translateX(-${e}px)`}changePoints(t){t=t<0?this.sliderLine.children.length-1:t>this.sliderLine.children.length-1?0:t,this.pointsElem.children[this.pointNumber].classList.remove(this.pointClassName),this.pointsElem.children[t].classList.add(this.pointClassName),this.pointNumber=t,this.moveSlider(t)}startWithPressedMouse(t){this.isPressed=!0,this.startDistance=t.clientX,this.stopTimer(),this.initialSlide=t.target.closest("[data-slider-item]"),this.initialTransform=+getComputedStyle(this.sliderLine).transform.split(",")[4],this.sliderLine.style.transition="initial",window.addEventListener("mousemove",this.moveWithPressedMouse)}endWithPressedMouse(t){if(!this.isPressed)return;this.isPressed=!1,this.sliderLine.style.transition="";let e=t-this.startDistance;Math.abs(e)<.3*this.sliderLine.offsetWidth?this.sliderLine.style.transform=`translateX(${this.initialTransform}px)`:this.changePoints(e<0?this.pointNumber+1:this.pointNumber-1),window.removeEventListener("mousemove",this.moveWithPressedMouse)}moveWithPressedMouse(t){let e=t.clientX-this.startDistance,s=this.initialTransform+e,i=-(this.sliderLine.scrollWidth-this.sliderLine.clientWidth);s=s>=0?0:s<=i?i:s,this.sliderLine.style.transform=`translateX(${s}px)`;let n=document.elementFromPoint(t.clientX,t.clientY);this.sliderLine.contains(n)||this.endWithPressedMouse(this.prevClientX),this.prevClientX=t.clientX,t.preventDefault()}startTimer(){this.interval=setInterval(()=>{console.log(`setTimeout: ${this.timeout}`);let t=this.pointNumber+1;this.changePoints(t)},1e3*this.time)}stopTimer(){clearInterval(this.interval)}reset(){this.sliderLine.style.transform="translateX(0px)",this.changePoints(0)}}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lbnUuanMiLCJzbGlkZXIuanMiXSwibmFtZXMiOlsibWVudSIsImJ0biIsImJ0bkNsYXNzIiwiZWxlbWVudHMiLCJjbGFzc0xpc3QiLCJvbmNsaWNrIiwiY29udGFpbnMiLCJzdHlsZSIsInRvcCIsImxlZnQiLCJjb29yZHMiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b2dnbGUiLCJmb3JFYWNoIiwiaXRlbSIsImkiLCJTbGlkZXIiLCJbb2JqZWN0IE9iamVjdF0iLCJzbGlkZXIiLCJwb2ludENsYXNzTmFtZSIsInBvaW50c0VsZW0iLCJ0aW1lIiwiYXJyb3dMZWZ0IiwiYXJyb3dSaWdodCIsInRoaXMiLCJzbGlkZXJMaW5lIiwicXVlcnlTZWxlY3RvciIsImNzc1RleHQiLCJwb2ludE51bWJlciIsImludGVydmFsIiwiaXNQcmVzc2VkIiwibW92ZVdpdGhQcmVzc2VkTW91c2UiLCJiaW5kIiwicGFyc2VJbnQiLCJzdGFydFRpbWVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN0b3BUaW1lciIsImhhbmRsZUV2ZW50Iiwid2luZG93IiwicmVzZXQiLCJldmVudCIsInBvaW50IiwidGFyZ2V0IiwiY2xvc2VzdCIsInR5cGUiLCJwcmV2ZW50RGVmYXVsdCIsImRhdGFzZXQiLCJzbGlkZXJQb2ludCIsImNoYW5nZVBvaW50cyIsInN0YXJ0V2l0aFByZXNzZWRNb3VzZSIsImVuZFdpdGhQcmVzc2VkTW91c2UiLCJjbGllbnRYIiwiaW5kZXgiLCJzY3JvbGxXaWR0aCIsImNoaWxkcmVuIiwibGVuZ3RoIiwidHJhbnNmb3JtIiwicmVtb3ZlIiwiYWRkIiwibW92ZVNsaWRlciIsInN0YXJ0RGlzdGFuY2UiLCJpbml0aWFsU2xpZGUiLCJpbml0aWFsVHJhbnNmb3JtIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsInNwbGl0IiwidHJhbnNpdGlvbiIsImRpZmZPZkRpc3RhbmNlIiwiTWF0aCIsImFicyIsIm9mZnNldFdpZHRoIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNoaWZ0IiwibWF4U2hpZnQiLCJjbGllbnRXaWR0aCIsImN1cnJlbnRFbGVtIiwiZG9jdW1lbnQiLCJlbGVtZW50RnJvbVBvaW50IiwiY2xpZW50WSIsInByZXZDbGllbnRYIiwic2V0SW50ZXJ2YWwiLCJjb25zb2xlIiwibG9nIiwidGltZW91dCIsImNsZWFySW50ZXJ2YWwiXSwibWFwcGluZ3MiOiJBQUFBLFNBQUFBLEtBQUFDLEVBQUFDLEdBQUFDLFNBQ0FBLEVBQUFDLFVBQ0FBLElBRUFILEVBQUFJLFFBQUEsS0FDQSxHQUFBSixFQUFBRyxVQUFBRSxTQUFBSixHQUtBRCxFQUFBTSxNQUFBQyxJQUFBUCxFQUFBTSxNQUFBRSxLQUFBLE9BTEEsQ0FDQSxJQUFBQyxFQUFBVCxFQUFBVSx3QkFDQVYsRUFBQU0sTUFBQUUsS0FBQUMsRUFBQUQsS0FBQSxLQUNBUixFQUFBTSxNQUFBQyxJQUFBRSxFQUFBRixJQUFBLEtBSUFQLEVBQUFHLFVBQUFRLE9BQUFWLEdBQ0FDLEVBQUFVLFFBQUEsQ0FBQUMsRUFBQUMsS0FDQVgsRUFBQVcsSUFBQUQsRUFBQVYsVUFBQVEsT0FBQVIsRUFBQVcsT0NiQSxNQUFBQyxPQUNBQyxZQUFBQyxHQUFBQyxlQUFBQSxFQUFBQyxXQUFBQSxFQUFBQyxLQUFBQSxFQUFBQyxVQUFBQSxFQUFBQyxXQUFBQSxJQUNBQyxLQUFBQyxXQUFBUCxFQUFBUSxjQUFBLHNCQUNBRixLQUFBQyxhQUVBRCxLQUFBQyxXQUFBbEIsTUFBQW9CLFFBQUEsOEJBRUFILEtBQUFKLFdBQUFBLEVBQ0FJLEtBQUFMLGVBQUFBLEdBQUEsaUJBQ0FLLEtBQUFJLFlBQUEsRUFFQUosS0FBQUssU0FDQUwsS0FBQUgsS0FBQUEsRUFFQUcsS0FBQU0sV0FBQSxFQUNBTixLQUFBTyxxQkFBQVAsS0FBQU8scUJBQUFDLEtBQUFSLE1BRUFTLFNBQUFaLEtBQ0FHLEtBQUFVLGFBQ0FWLEtBQUFDLFdBQUFVLGlCQUFBLGFBQUFYLEtBQUFZLFVBQUFKLEtBQUFSLE9BQ0FBLEtBQUFDLFdBQUFVLGlCQUFBLGFBQUFYLEtB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RCxLQUFBc0QsWUFBQXRDLEVBQUFXLFFBRUFYLEVBQUFLLGlCQUlBNUIsYUFDQU8sS0FBQUssU0FBQWtELFlBQUEsS0FDQUMsUUFBQUMsSUFBQSxlQUFBekQsS0FBQTBELFdBQ0EsSUFBQTlCLEVBQUE1QixLQUFBSSxZQUFBLEVBQ0FKLEtBQUF3QixhQUFBSSxJQUNBLElBQUE1QixLQUFBSCxNQUdBSixZQUNBa0UsY0FBQTNELEtBQUFLLFVBR0FaLFFBQ0FPLEtBQUFDLFdBQUFsQixNQUFBaUQsVUFBQSxrQkFDQWhDLEtBQUF3QixhQUFBIiwiZmlsZSI6ImxpYnMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gbWVudShidG4sIGJ0bkNsYXNzLCB7XHJcbiAgICBlbGVtZW50cyxcclxuICAgIGNsYXNzTGlzdCxcclxufSkge1xyXG4gICAgYnRuLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYoIWJ0bi5jbGFzc0xpc3QuY29udGFpbnMoYnRuQ2xhc3MpKSB7XHJcbiAgICAgICAgICAgIGxldCBjb29yZHMgPSBidG4uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgIGJ0bi5zdHlsZS5sZWZ0ID0gY29vcmRzLmxlZnQgKyAncHgnO1xyXG4gICAgICAgICAgICBidG4uc3R5bGUudG9wID0gY29vcmRzLnRvcCArICdweCc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYnRuLnN0eWxlLnRvcCA9IGJ0bi5zdHlsZS5sZWZ0ID0gXCJcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgYnRuLmNsYXNzTGlzdC50b2dnbGUoYnRuQ2xhc3MpO1xyXG4gICAgICAgIGVsZW1lbnRzLmZvckVhY2goKGl0ZW0sIGkpID0+IHtcclxuICAgICAgICAgICAgaWYoY2xhc3NMaXN0W2ldKWl0ZW0uY2xhc3NMaXN0LnRvZ2dsZShjbGFzc0xpc3RbaV0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59OyIsIlxyXG5jbGFzcyBTbGlkZXIge1xyXG4gICAgY29uc3RydWN0b3Ioc2xpZGVyLCB7cG9pbnRDbGFzc05hbWUsIHBvaW50c0VsZW0sIHRpbWUsIGFycm93TGVmdCwgYXJyb3dSaWdodH0pIHsgLy90aGUgdGltZSBhcmd1bWVudCB0YWtlcyBhIG51bWJlciB2YWx1ZSBhcyBzZWNvbmRzXHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lID0gc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXNsaWRlci1saW5lXScpO1xyXG4gICAgICAgIGlmKCF0aGlzLnNsaWRlckxpbmUpIHJldHVybjtcclxuXHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLmNzc1RleHQgPSBcInRyYW5zZm9ybTogdHJhbnNsYXRlWCgwcHgpO1wiXHJcblxyXG4gICAgICAgIHRoaXMucG9pbnRzRWxlbSA9IHBvaW50c0VsZW07XHJcbiAgICAgICAgdGhpcy5wb2ludENsYXNzTmFtZSA9IHBvaW50Q2xhc3NOYW1lIHx8ICdwb2ludENsYXNzTmFtZSc7XHJcbiAgICAgICAgdGhpcy5wb2ludE51bWJlciA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuaW50ZXJ2YWw7XHJcbiAgICAgICAgdGhpcy50aW1lID0gdGltZTtcclxuXHJcbiAgICAgICAgdGhpcy5pc1ByZXNzZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm1vdmVXaXRoUHJlc3NlZE1vdXNlID0gdGhpcy5tb3ZlV2l0aFByZXNzZWRNb3VzZS5iaW5kKHRoaXMpO1xyXG5cclxuICAgICAgICBpZihwYXJzZUludCh0aW1lKSkge1xyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0VGltZXIoKTsgIFxyXG4gICAgICAgICAgICB0aGlzLnNsaWRlckxpbmUuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIHRoaXMuc3RvcFRpbWVyLmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICB0aGlzLnNsaWRlckxpbmUuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIHRoaXMuc3RhcnRUaW1lci5iaW5kKHRoaXMpKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBzbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZUV2ZW50LmJpbmQodGhpcykpO1xyXG4gICAgICAgIHNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLmhhbmRsZUV2ZW50LmJpbmQodGhpcykpO1xyXG4gICAgICAgIHNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5oYW5kbGVFdmVudC5iaW5kKHRoaXMpKTtcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5yZXNldC5iaW5kKHRoaXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVFdmVudChldmVudCkge1xyXG5cclxuICAgICAgICBsZXQgcG9pbnQgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnW2RhdGEtc2xpZGVyLXBvaW50XScpO1xyXG4gICAgICAgIGlmKHBvaW50ICYmIGV2ZW50LnR5cGUgPT0gXCJjbGlja1wiKSB7XHJcbiAgICAgICAgICAgIGlmKCFwb2ludC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5wb2ludENsYXNzTmFtZSkpIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IC8vcHJldmVudCB0aGUgcHJlc3NlZCBsaW5rIGdvaW5nIGlmIGl0IGlzIHRoZSBmaXJzdCB0aW1lXHJcbiAgICAgICAgICAgIGlmKHBvaW50LmRhdGFzZXQuc2xpZGVyUG9pbnQgLSAxID09IHRoaXMucG9pbnROdW1iZXIpIHJldHVybjsgLy9pZiB0aGUgcHJlc3NlZCBidXR0b24gaXMgdGhlIHNhbWUgb25lIGxpa2UgaW4gdGhlIHByZXZpb3VzIHRpbWUgdGhlbiB0byByZXR1cm5cclxuICAgICAgICAgICAgaWYodGhpcy50aW1lKSB7IC8vIGlmIHRoZSBwb2ludCBoYXZlIHByZXNzZWQgdGhlbiB0byBjYW5jZWwgdGhlIGN1cnJlbnQgdGltZXIgYW5kIHN0YXJ0IGl0IHVudGlsbCB0aGUgdHJhbnNpdGlvbiBlbmQgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BUaW1lcigpOyAvLyBzdG9wIHRoZSB0aW1lciBhbnl3YXlcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRUaW1lcigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlUG9pbnRzKHBvaW50LmRhdGFzZXQuc2xpZGVyUG9pbnQgLSAxKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ1tkYXRhLXNsaWRlci1saW5lXScpKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaChldmVudC50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdtb3VzZWRvd24nOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRXaXRoUHJlc3NlZE1vdXNlKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhazsgIFxyXG4gICAgICAgICAgICAgICAgY2FzZSAnZGJjbGljayc6ICAgIFxyXG4gICAgICAgICAgICAgICAgY2FzZSAnbW91c2V1cCc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRXaXRoUHJlc3NlZE1vdXNlKGV2ZW50LmNsaWVudFgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBcclxuICAgICAgICAvL2lmKGV2ZW50LnRhcmdldC5jbG9zZXN0KCdbZGF0YS1zbGlkZXItYXJyb3ddJykpIHRoaXMuYXJyb3dzKGV2ZW50LnRhcmdldCk7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgLyogYXJyb3dzKGVsZW0pIHtcclxuICAgICAgICBsZXQgb2Zmc2V0V2lkdGggPSB0aGlzLnNsaWRlckxpbmUub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgbGV0IGxlZnQgPSBwYXJzZUludCh0aGlzLnNsaWRlckxpbmUuc3R5bGUubGVmdCk7XHJcbiAgICAgICAgbGV0IGFtb3VudCA9IChlbGVtLmRhdGFzZXQuc2xpZGVyQXJyb3cgPT0gJ2xlZnQnKSA/IGxlZnQgKyBvZmZzZXRXaWR0aCA6IGxlZnQgLSBvZmZzZXRXaWR0aDtcclxuICAgICAgICBhbW91bnQgPSAoYW1vdW50ID4gMCkgPyAwIDpcclxuICAgICAgICAvLyBpZiB0aGUgcmVzdCBwYXJ0IG9mIHNsaWRlciBsaW5lIHNtYWxsZXIgdGhhbiAxMHB4IHRoZW4gbm8gY2hhbmdlc1xyXG4gICAgICAgICh0aGlzLnNsaWRlckxpbmUuc2Nyb2xsV2lkdGggKyBhbW91bnQgPCAxMCkgPyBhbW91bnQgKyBvZmZzZXRXaWR0aCA6IGFtb3VudDtcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUubGVmdCA9IGFtb3VudCArIFwicHhcIjtcclxuICAgIH0gKi9cclxuXHJcbiAgICBtb3ZlU2xpZGVyKGluZGV4KSB7IC8vIGNoYW5nZXMgKG1vdmVzKSB0aGUgc2xpZGVyIHRhcGUgKHNsaWRlciBsaW5lKSBwb3NpdGlvblxyXG4gICAgICAgIGxldCBsZWZ0ID0gdGhpcy5zbGlkZXJMaW5lLnNjcm9sbFdpZHRoIC8gdGhpcy5zbGlkZXJMaW5lLmNoaWxkcmVuLmxlbmd0aCAqIGluZGV4O1xyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgtJHtsZWZ0fXB4KWA7XHJcbiAgICB9XHJcblxyXG4gICAgY2hhbmdlUG9pbnRzKGluZGV4KSB7IC8vIGNoYW5nZXMgYSBjbGFzcyBvZiB0aGUgcHJlc3NlZCBidXR0b24gKHNsaWRlciBwb2ludCkgYW5kIG1vdmVzIHRoZSBzbGlkZXIgdGFwZSAoc2xpZGVyIGxpbmUpICBcclxuICAgICAgICBpbmRleCA9IChpbmRleCA8IDApID8gdGhpcy5zbGlkZXJMaW5lLmNoaWxkcmVuLmxlbmd0aCAtIDEgOiBcclxuICAgICAgICAgICAgICAgIChpbmRleCA+IHRoaXMuc2xpZGVyTGluZS5jaGlsZHJlbi5sZW5ndGggLSAxKSA/IDAgOiBpbmRleDtcclxuXHJcbiAgICAgICAgdGhpcy5wb2ludHNFbGVtLmNoaWxkcmVuW3RoaXMucG9pbnROdW1iZXJdLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5wb2ludENsYXNzTmFtZSk7XHJcbiAgICAgICAgdGhpcy5wb2ludHNFbGVtLmNoaWxkcmVuW2luZGV4XS5jbGFzc0xpc3QuYWRkKHRoaXMucG9pbnRDbGFzc05hbWUpO1xyXG4gICAgICAgIHRoaXMucG9pbnROdW1iZXIgPSBpbmRleDtcclxuICAgICAgICB0aGlzLm1vdmVTbGlkZXIoaW5kZXgpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBzdGFydFdpdGhQcmVzc2VkTW91c2UoZXZlbnQpIHtcclxuICAgICAgICB0aGlzLmlzUHJlc3NlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zdGFydERpc3RhbmNlID0gZXZlbnQuY2xpZW50WDtcclxuICAgICAgICB0aGlzLnN0b3BUaW1lcigpO1xyXG5cclxuICAgICAgICB0aGlzLmluaXRpYWxTbGlkZSA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCdbZGF0YS1zbGlkZXItaXRlbV0nKTsgLy9kZWNpc2lvbiBvZiBjdXJyZW50bHkgZm9yIGEgc2luZ2xlIHZpc2libGUgc2xpZGUgb2YgdGhlIHNsaWRlclxyXG5cclxuICAgICAgICB0aGlzLmluaXRpYWxUcmFuc2Zvcm0gPSArZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLnNsaWRlckxpbmUpLnRyYW5zZm9ybS5zcGxpdCgnLCcpWzRdO1xyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2l0aW9uID0gJ2luaXRpYWwnO1xyXG5cclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5tb3ZlV2l0aFByZXNzZWRNb3VzZSk7XHJcbiAgICB9XHJcbiAgICBlbmRXaXRoUHJlc3NlZE1vdXNlKGNsaWVudFgpIHtcclxuICAgICAgICBpZighdGhpcy5pc1ByZXNzZWQpIHJldHVybjtcclxuXHJcbiAgICAgICAgdGhpcy5pc1ByZXNzZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUudHJhbnNpdGlvbiA9ICcnO1xyXG5cclxuICAgICAgICBsZXQgZGlmZk9mRGlzdGFuY2UgPSBjbGllbnRYIC0gdGhpcy5zdGFydERpc3RhbmNlO1xyXG4gICAgICAgIGlmKE1hdGguYWJzKGRpZmZPZkRpc3RhbmNlKSAgPCB0aGlzLnNsaWRlckxpbmUub2Zmc2V0V2lkdGggKiAuMykge1xyXG4gICAgICAgICAgICB0aGlzLnNsaWRlckxpbmUuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoJHt0aGlzLmluaXRpYWxUcmFuc2Zvcm19cHgpYDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZVBvaW50cygoZGlmZk9mRGlzdGFuY2UgPCAwKSA/IHRoaXMucG9pbnROdW1iZXIgKyAxIDogdGhpcy5wb2ludE51bWJlciAtIDEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMubW92ZVdpdGhQcmVzc2VkTW91c2UpO1xyXG4gICAgfVxyXG4gICAgbW92ZVdpdGhQcmVzc2VkTW91c2UoZXZlbnQpIHtcclxuICAgICAgICBsZXQgZGlmZk9mRGlzdGFuY2UgPSAgZXZlbnQuY2xpZW50WCAtIHRoaXMuc3RhcnREaXN0YW5jZTtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgc2hpZnQgPSB0aGlzLmluaXRpYWxUcmFuc2Zvcm0gKyBkaWZmT2ZEaXN0YW5jZTtcclxuICAgICAgICBsZXQgbWF4U2hpZnQgPSAtKHRoaXMuc2xpZGVyTGluZS5zY3JvbGxXaWR0aCAtIHRoaXMuc2xpZGVyTGluZS5jbGllbnRXaWR0aCk7XHJcbiAgICAgICAgc2hpZnQgPSAoc2hpZnQgPj0gMCkgPyAwIDpcclxuICAgICAgICAgICAgICAgIChzaGlmdCA8PSBtYXhTaGlmdCkgPyBtYXhTaGlmdCA6IHNoaWZ0OyAgICAgICBcclxuXHJcbiAgICAgICAgdGhpcy5zbGlkZXJMaW5lLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKCR7c2hpZnR9cHgpYDtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgY3VycmVudEVsZW0gPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkpO1xyXG4gICAgICAgIGlmKCF0aGlzLnNsaWRlckxpbmUuY29udGFpbnMoY3VycmVudEVsZW0pKSB0aGlzLmVuZFdpdGhQcmVzc2VkTW91c2UodGhpcy5wcmV2Q2xpZW50WCk7XHJcblxyXG4gICAgICAgIHRoaXMucHJldkNsaWVudFggPSBldmVudC5jbGllbnRYOyBcclxuXHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgc3RhcnRUaW1lcigpIHtcclxuICAgICAgICB0aGlzLmludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgc2V0VGltZW91dDogJHt0aGlzLnRpbWVvdXR9YCk7XHJcbiAgICAgICAgICAgIGxldCBpbmRleCA9IHRoaXMucG9pbnROdW1iZXIgKyAxO1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZVBvaW50cyhpbmRleCk7XHJcbiAgICAgICAgfSwgdGhpcy50aW1lICogMTAwMCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHN0b3BUaW1lcigpIHtcclxuICAgICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0KCkge1xyXG4gICAgICAgIHRoaXMuc2xpZGVyTGluZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgwcHgpYDtcclxuICAgICAgICB0aGlzLmNoYW5nZVBvaW50cygwKTtcclxuICAgIH1cclxufTtcclxuXHJcbi8vIFBhdHRlcm4gb2YgdGhlIEhUTUwgc2xpZGVyOlxyXG4vLyBibG9jayBzbGlkZXIgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRlZmluZXMgdGhlIHRvdGFsIHdpZHRoIG9mIHRoZSBzbGlkZXIncyBwYWdlIChjb250YWluZXIpXHJcbi8vICAgICBibG9jayBzbGlkZXItY29udGFpbmVyICAgICAgICAgICAgLy8gZGVmaW5lcyBhIHdpZHRoIG9mIHRoZSBzbGlkZXIgXHJcbi8vICAgICAgICAgYmxvY2sgW2RhdGEtc2xpZGVyLWxpbmVdICAgICAgICAgICAgIC8vIGRlZmluZXMgdGhlIHRhcGUgb2YgdGhlIHNsaWRlciwgdGhhdCBtb3ZlcyB0aHJvdWdoXHJcbi8vICAgICAgICAgICAgIGJsb2NrcyBbZGF0YS1zbGlkZXItaXRlbT0nbnVtYmVyJ10gKiBuXHJcbi8vICAgICAgICAgYmxvY2sgc2xpZGVyLWFycm93cyAgIFxyXG4vLyAgICAgICAgIGJsb2NrIHNsaWRlci1wb2ludHNcclxuLy8gICAgICAgICAgICAgYmxvY2tzIFtkYXRhLXNsaWRlci1wb2ludD0nbnVtYmVyJ10gKiBuXHJcblxyXG5cclxuXHJcblxyXG4vL3RoaXMudHJhbnNpdGlvblN0YXJ0VGltZXIoKTsgLy8gdXNlIHRyYW5zaXRpb25TdGFydFRpbWVyIGluc3RlYWQgdXN1YWxsIHN0YXJ0VGltZXIgdG8gY29uc2lkZXIgdHJhbnNpdGlvbiB0aW1lXHJcblxyXG4vL3RoaXMuc2xpZGVyTGluZS5vbnRyYW5zaXRpb25lbmQgPSBmYWxzZTtcclxuXHJcbi8vIHRyYW5zaXRpb25TdGFydFRpbWVyKCkgeyAvLyBzdGFydHMgdGhlIG5leHQgdGltZSBpbnRlcnZhbCBhZnRlciB0aGUgY3VycmVudCB0cmFuc2l0aW9uIG9ubHlcclxuLy8gICAgIGlmKHBhcnNlRmxvYXQoZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLnNsaWRlckxpbmUpLnRyYW5zaXRpb25EdXJhdGlvbikpIHsgLy8gaWYgdGhlcmUncyBzb21lIGFuaW1hdGlvblxyXG4vLyAgICAgICAgIHRoaXMuc2xpZGVyTGluZS5vbnRyYW5zaXRpb25lbmQgPSAoKSA9PiB7XHJcbi8vICAgICAgICAgICAgIHRoaXMuc3RhcnRUaW1lcigpO1xyXG4vLyAgICAgICAgICAgICB0aGlzLnNsaWRlckxpbmUub250cmFuc2l0aW9uZW5kID0gZmFsc2U7XHJcbi8vICAgICAgICAgfVxyXG4vLyAgICAgfSBlbHNlIHtcclxuLy8gICAgICAgICB0aGlzLnN0YXJ0VGltZXIoKTtcclxuLy8gICAgIH1cclxuLy8gfVxyXG5cclxuIl19
